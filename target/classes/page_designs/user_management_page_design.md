# 用户管理页面详细设计

## 1. 管理员列表页

### 1.1 页面布局
- **顶部区域**：
  - 页面标题："管理员列表"
  - 操作按钮：
    - 【新增管理员】- 打开新增管理员弹窗
    - 【刷新列表】- 刷新当前列表
    - 【批量删除】- 批量删除选中的管理员

- **筛选区域**：
  - 用户名输入框
  - 真实姓名输入框
  - 手机号输入框
  - 邮箱输入框
  - 状态筛选（全部/启用/禁用）
  - 【查询】按钮
  - 【重置】按钮

- **表格区域**：
  - 复选框列（支持全选/取消全选）
  - ID列
  - 用户名列
  - 真实姓名列
  - 手机号列
  - 邮箱列
  - 角色列（显示角色名称）
  - 状态列（启用/禁用，支持开关切换）
  - 创建时间列
  - 操作列：【编辑】【删除】【分配角色】

- **分页区域**：
  - 总记录数显示
  - 每页条数选择
  - 页码跳转
  - 上一页/下一页按钮

### 1.2 表单设计（新增/编辑管理员）
| 字段名称 | 字段类型 | 必填 | 说明 |
|----------|----------|------|------|
| 用户名 | 输入框 | 是 | 长度不超过50字符，唯一 |
| 密码 | 密码框 | 是（新增）/否（编辑） | 长度8-20字符，包含字母、数字和特殊字符 |
| 真实姓名 | 输入框 | 否 | 长度不超过50字符 |
| 手机号 | 输入框 | 否 | 11位数字，唯一 |
| 邮箱 | 输入框 | 否 | 合法邮箱格式，唯一 |
| 头像 | 上传组件 | 否 | 支持图片上传，限制大小2MB |
| 角色 | 下拉选择 | 是 | 可选择多个角色 |
| 状态 | 开关 | 是 | 启用/禁用 |

### 1.3 交互设计
- 点击【新增管理员】按钮，弹出新增管理员表单
- 点击【编辑】按钮，弹出编辑管理员表单，预填当前数据
- 点击【删除】按钮，弹出确认删除对话框
- 点击【分配角色】按钮，跳转到权限分配页
- 状态列开关切换时，实时更新管理员状态
- 支持表格列排序（ID、创建时间）
- 支持表格列筛选

## 2. 员工列表页

### 2.1 页面布局
- **顶部区域**：
  - 页面标题："员工列表"
  - 操作按钮：
    - 【新增员工】- 打开新增员工弹窗
    - 【刷新列表】- 刷新当前列表
    - 【批量删除】- 批量删除选中的员工

- **筛选区域**：
  - 用户名输入框
  - 真实姓名输入框
  - 手机号输入框
  - 邮箱输入框
  - 角色筛选（下拉选择）
  - 状态筛选（全部/启用/禁用）
  - 【查询】按钮
  - 【重置】按钮

- **表格区域**：
  - 复选框列（支持全选/取消全选）
  - ID列
  - 用户名列
  - 真实姓名列
  - 手机号列
  - 邮箱列
  - 角色列（显示角色名称）
  - 状态列（启用/禁用，支持开关切换）
  - 创建时间列
  - 操作列：【编辑】【删除】【分配角色】【查看日志】

- **分页区域**：
  - 总记录数显示
  - 每页条数选择
  - 页码跳转
  - 上一页/下一页按钮

### 2.2 表单设计（新增/编辑员工）
| 字段名称 | 字段类型 | 必填 | 说明 |
|----------|----------|------|------|
| 用户名 | 输入框 | 是 | 长度不超过50字符，唯一 |
| 密码 | 密码框 | 是（新增）/否（编辑） | 长度8-20字符，包含字母、数字和特殊字符 |
| 真实姓名 | 输入框 | 是 | 长度不超过50字符 |
| 手机号 | 输入框 | 是 | 11位数字，唯一 |
| 邮箱 | 输入框 | 否 | 合法邮箱格式，唯一 |
| 头像 | 上传组件 | 否 | 支持图片上传，限制大小2MB |
| 角色 | 下拉选择 | 是 | 可选择多个角色，默认只能选择非超级管理员角色 |
| 状态 | 开关 | 是 | 启用/禁用 |

### 2.3 交互设计
- 点击【新增员工】按钮，弹出新增员工表单
- 点击【编辑】按钮，弹出编辑员工表单，预填当前数据
- 点击【删除】按钮，弹出确认删除对话框
- 点击【分配角色】按钮，跳转到权限分配页
- 点击【查看日志】按钮，跳转到操作日志页，筛选当前员工的日志
- 状态列开关切换时，实时更新员工状态
- 支持表格列排序（ID、创建时间）
- 支持表格列筛选

## 3. 角色管理页

### 3.1 页面布局
- **顶部区域**：
  - 页面标题："角色管理"
  - 操作按钮：
    - 【新增角色】- 打开新增角色弹窗
    - 【刷新列表】- 刷新当前列表
    - 【批量删除】- 批量删除选中的角色

- **筛选区域**：
  - 角色名称输入框
  - 角色编码输入框
  - 状态筛选（全部/启用/禁用）
  - 【查询】按钮
  - 【重置】按钮

- **表格区域**：
  - 复选框列（支持全选/取消全选）
  - ID列
  - 角色名称列
  - 角色编码列
  - 描述列
  - 状态列（启用/禁用，支持开关切换）
  - 创建时间列
  - 操作列：【编辑】【删除】【权限分配】

- **分页区域**：
  - 总记录数显示
  - 每页条数选择
  - 页码跳转
  - 上一页/下一页按钮

### 3.2 表单设计（新增/编辑角色）
| 字段名称 | 字段类型 | 必填 | 说明 |
|----------|----------|------|------|
| 角色名称 | 输入框 | 是 | 长度不超过50字符 |
| 角色编码 | 输入框 | 是 | 长度不超过50字符，唯一，建议使用大写字母和下划线 |
| 描述 | 文本域 | 否 | 长度不超过255字符 |
| 状态 | 开关 | 是 | 启用/禁用 |

### 3.3 交互设计
- 点击【新增角色】按钮，弹出新增角色表单
- 点击【编辑】按钮，弹出编辑角色表单，预填当前数据
- 点击【删除】按钮，弹出确认删除对话框，超级管理员角色不可删除
- 点击【权限分配】按钮，跳转到权限分配页，显示当前角色的权限配置
- 状态列开关切换时，实时更新角色状态
- 支持表格列排序（ID、创建时间）
- 支持表格列筛选

## 4. 权限分配页

### 4.1 页面布局
- **顶部区域**：
  - 页面标题："权限分配"
  - 操作按钮：
    - 【保存权限】- 保存当前权限配置
    - 【取消】- 取消当前操作，返回上一页

- **角色选择区域**：
  - 角色下拉选择框 - 选择要分配权限的角色
  - 角色信息显示 - 显示当前角色的名称、编码和描述

- **权限配置区域**：
  - **菜单权限**：
    - 树形菜单结构，显示所有菜单
    - 支持勾选/取消勾选菜单
    - 支持全选/取消全选
    - 显示菜单名称、菜单路径、组件路径、权限标识
  - **按钮权限**：
    - 当选中某个菜单时，显示该菜单下的按钮权限
    - 支持勾选/取消勾选按钮权限
    - 显示按钮名称、权限标识

### 4.2 权限配置规则
| 权限类型 | 配置方式 | 说明 |
|----------|----------|------|
| 菜单权限 | 树形勾选 | 勾选表示拥有该菜单的访问权限 |
| 按钮权限 | 列表勾选 | 勾选表示拥有该按钮的操作权限 |
| 数据权限 | 配置项选择 | 根据角色配置数据访问范围 |

### 4.3 交互设计
- 选择角色后，自动加载该角色已有的权限配置
- 菜单权限支持展开/折叠
- 勾选父菜单时，自动勾选所有子菜单
- 取消勾选父菜单时，自动取消勾选所有子菜单
- 勾选子菜单时，如果所有子菜单都勾选，则自动勾选父菜单
- 取消勾选子菜单时，如果还有子菜单勾选，则父菜单显示半选状态
- 点击【保存权限】按钮，弹出确认保存对话框，保存成功后提示
- 点击【取消】按钮，弹出确认取消对话框，取消后返回上一页
- 权限配置变更后，显示未保存状态提示

## 5. 数据模型关联

### 5.1 管理员/员工列表页
- 关联表：`sys_users`、`sys_roles`、`sys_user_roles`
- 数据来源：
  - 用户基本信息：`sys_users`
  - 用户角色信息：`sys_roles` + `sys_user_roles`

### 5.2 角色管理页
- 关联表：`sys_roles`
- 数据来源：`sys_roles`

### 5.3 权限分配页
- 关联表：`sys_roles`、`sys_menus`、`sys_role_menus`
- 数据来源：
  - 角色信息：`sys_roles`
  - 菜单信息：`sys_menus`
  - 角色菜单关联：`sys_role_menus`

## 6. 技术实现建议

### 6.1 前端实现
- 使用React/Vue框架
- 采用Ant Design/Element UI组件库
- 使用树形组件实现菜单权限配置
- 使用表格组件实现列表展示
- 使用表单组件实现数据录入

### 6.2 后端实现
- 基于RBAC（Role-Based Access Control）模型
- 提供RESTful API接口
- 实现权限验证中间件
- 日志记录功能

### 6.3 安全考虑
- 密码加密存储
- 权限验证严格
- 操作日志记录
- 防止SQL注入
- 防止XSS攻击

## 7. 页面间关系

```
┌─────────────────┐     ┌─────────────────┐
│ 管理员列表页   │────▶│ 权限分配页     │
└─────────────────┘     └─────────────────┘
        ▲                        ▲
        │                        │
┌─────────────────┐     ┌─────────────────┐
│ 员工列表页     │────▶│ 角色管理页     │
└─────────────────┘     └─────────────────┘
```

- 管理员列表页和员工列表页都可以跳转到权限分配页
- 角色管理页可以跳转到权限分配页
- 权限分配页是核心的权限配置页面

## 8. 扩展建议

### 8.1 功能扩展
- 支持数据权限配置，限制角色能访问的数据范围
- 支持权限模板，快速复制权限配置
- 支持权限变更记录，追踪权限变更历史

### 8.2 性能优化
- 权限数据缓存，减少数据库查询
- 树形菜单懒加载，提高页面加载速度
- 表格数据分页加载，优化大数据量展示

### 8.3 用户体验
- 提供权限配置预览功能
- 支持权限配置导入/导出
- 提供权限配置示例
- 优化权限配置界面，提高操作效率
