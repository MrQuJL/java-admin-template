# 实现Easy Excel导出用户数据功能

## 1. 技术方案
使用阿里的Easy Excel库实现用户数据的Excel导出功能，主要包含以下步骤：

## 2. 实现步骤

### 步骤1：创建Excel导出模型类
- 文件名：`SysUserExcel.java`
- 位置：`com.ecommerce.admin.module.system.vo`包下
- 使用Easy Excel注解定义Excel表头
- 包含用户的基本信息（不包含密码等敏感字段）

### 步骤2：修改SysUserService接口
- 添加方法：`List<SysUser> listAll()`
- 用于获取所有用户数据

### 步骤3：实现SysUserService接口
- 在`SysUserServiceImpl`中实现`listAll()`方法
- 使用MyBatis-Plus的`list()`方法获取所有用户数据

### 步骤4：添加Excel导出Controller方法
- 在`SysUserController`中添加`exportExcel()`方法
- 使用Easy Excel API生成Excel文件
- 设置响应头，让浏览器下载文件

## 3. 核心代码设计

### Excel导出模型类
```java
@Data
public class SysUserExcel {
    @ExcelProperty(value = "用户ID", index = 0)
    private Long id;
    
    @ExcelProperty(value = "用户名", index = 1)
    private String username;
    
    @ExcelProperty(value = "真实姓名", index = 2)
    private String realName;
    
    @ExcelProperty(value = "邮箱", index = 3)
    private String email;
    
    @ExcelProperty(value = "手机号", index = 4)
    private String phone;
    
    @ExcelProperty(value = "状态", index = 5)
    private String isActive;
    
    @ExcelProperty(value = "创建时间", index = 6, converter = LocalDateTimeConverter.class)
    private LocalDateTime createdAt;
    
    // 状态转换方法
    public String getIsActive() {
        return this.isActive == 1 ? "启用" : "禁用";
    }
}
```

### Service接口扩展
```java
// 在SysUserService中添加
List<SysUser> listAll();

// 在SysUserServiceImpl中实现
@Override
public List<SysUser> listAll() {
    return this.list();
}
```

### Controller导出方法
```java
@ApiOperation("导出用户数据")
@GetMapping("/export")
public void exportExcel(HttpServletResponse response) throws IOException {
    // 设置响应头
    response.setContentType("application/vnd.ms-excel");
    response.setCharacterEncoding("utf-8");
    String fileName = URLEncoder.encode("用户数据", "UTF-8");
    response.setHeader("Content-disposition", "attachment;filename=" + fileName + ".xlsx");
    
    // 获取所有用户数据
    List<SysUser> users = sysUserService.listAll();
    
    // 转换为Excel模型
    List<SysUserExcel> excelData = users.stream().map(user -> {
        SysUserExcel excel = modelMapper.map(user, SysUserExcel.class);
        return excel;
    }).collect(Collectors.toList());
    
    // 使用Easy Excel导出
    EasyExcel.write(response.getOutputStream(), SysUserExcel.class)
            .sheet("用户列表")
            .doWrite(excelData);
}
```

## 4. 预期效果
- 访问 `/system/user/export` 接口时，浏览器会下载一个名为"用户数据.xlsx"的Excel文件
- Excel文件包含所有用户的基本信息
- 状态字段会显示为"启用"或"禁用"，而非数字
- 创建时间会以格式化的方式显示