# 数据统计页面设计

## 1. 销售统计报表页

### 1.1 页面概述
- **页面URL**: `/admin/statistics/sales`
- **功能描述**: 展示销售数据的统计报表，包括销售额、订单数、客单价等指标，支持按时间、商品分类、支付方式等维度筛选

### 1.2 页面布局
- **顶部筛选区**: 时间范围、商品分类、支付方式、订单状态等筛选条件
- **数据概览区**: 关键指标卡片（总销售额、总订单数、客单价、转化率）
- **图表展示区**: 销售趋势图、销售构成图
- **数据表格区**: 销售明细表格
- **底部操作区**: 数据导出按钮

### 1.3 筛选条件设计
| 字段名 | 类型 | 必填 | 说明 | 选项 | 关联字段 |
|-------|------|------|------|------|----------|
| 时间范围 | 单选按钮组 | 否 | 选择数据统计的时间范围 | 今日、昨日、近7天、近30天、本月、上月、自定义 | order_orders.created_at |
| 自定义时间 | 日期范围选择器 | 否 | 当时间范围选择自定义时显示 | 开始日期、结束日期 | order_orders.created_at |
| 商品分类 | 树形选择器 | 否 | 按商品分类筛选 | 一级分类、二级分类 | product_categories.id |
| 支付方式 | 多选框 | 否 | 按支付方式筛选 | 支付宝、微信支付、银行卡 | order_orders.pay_type |
| 订单状态 | 多选框 | 否 | 按订单状态筛选 | 待付款、待发货、待收货、已完成、已取消、已退款、已退货 | order_orders.order_status |
| 数据维度 | 单选按钮组 | 否 | 选择数据统计的维度 | 日、周、月 | 无 |

### 1.4 数据概览卡片设计
| 卡片名称 | 数据指标 | 计算方式 | 数据来源 |
|---------|---------|---------|----------|
| 总销售额 | 显示所选时间范围内的总销售额 | SUM(actual_amount) | order_orders |
| 总订单数 | 显示所选时间范围内的总订单数 | COUNT(*) | order_orders |
| 客单价 | 显示所选时间范围内的平均客单价 | SUM(actual_amount) / COUNT(*) | order_orders |
| 转化率 | 显示所选时间范围内的转化率 | 订单数 / 访客数 | order_orders + 系统日志 |
| 退款率 | 显示所选时间范围内的退款率 | 退款订单数 / 总订单数 | order_orders |
| 平均发货时间 | 显示所选时间范围内的平均发货时间 | AVG(发货时间 - 下单时间) | order_orders + order_logistics |

### 1.5 图表设计

#### 1.5.1 销售趋势图
- **图表类型**: 折线图
- **X轴**: 时间（日、周、月）
- **Y轴**: 销售额、订单数
- **图例**: 销售额、订单数
- **交互**: 支持悬停查看具体数值，支持缩放和平移

#### 1.5.2 销售构成图
- **图表类型**: 饼图
- **数据维度**: 商品分类、支付方式、订单来源
- **交互**: 支持点击饼图区域查看详细数据，支持切换数据维度

#### 1.5.3 订单状态分布图
- **图表类型**: 柱状图
- **X轴**: 订单状态
- **Y轴**: 订单数量、销售额
- **交互**: 支持悬停查看具体数值，支持切换Y轴数据类型

### 1.6 数据表格设计
| 列名 | 类型 | 操作 | 数据来源 |
|------|------|------|----------|
| 日期 | 文本 | 无 | order_orders.created_at |
| 订单数 | 数字 | 无 | order_orders |
| 销售额 | 文本 | 无 | order_orders.actual_amount |
| 客单价 | 文本 | 无 | 计算字段 |
| 退款金额 | 文本 | 无 | order_orders.actual_amount (退款订单) |
| 退款率 | 文本 | 无 | 计算字段 |
| 操作 | 按钮组 | 查看详情 | 无 |

### 1.7 交互设计
- 支持动态切换时间范围
- 支持多条件组合筛选
- 支持图表类型切换
- 支持数据导出（Excel、CSV、PDF）
- 支持点击图表或表格跳转到相关详情页
- 支持数据自动刷新

## 2. 商品销售排行页

### 2.1 页面概述
- **页面URL**: `/admin/statistics/product-rank`
- **功能描述**: 展示商品销售排行，包括销量排行、销售额排行、利润排行等，支持按时间、商品分类等维度筛选

### 2.2 页面布局
- **顶部筛选区**: 时间范围、商品分类、排行类型等筛选条件
- **排行切换区**: 销量排行、销售额排行、利润排行等标签页
- **图表展示区**: 商品销售TOP10柱状图
- **数据表格区**: 商品销售排行表格
- **底部操作区**: 数据导出按钮

### 2.3 筛选条件设计
| 字段名 | 类型 | 必填 | 说明 | 选项 | 关联字段 |
|-------|------|------|------|------|----------|
| 时间范围 | 单选按钮组 | 否 | 选择数据统计的时间范围 | 今日、昨日、近7天、近30天、本月、上月、自定义 | order_orders.created_at |
| 自定义时间 | 日期范围选择器 | 否 | 当时间范围选择自定义时显示 | 开始日期、结束日期 | order_orders.created_at |
| 商品分类 | 树形选择器 | 否 | 按商品分类筛选 | 一级分类、二级分类 | product_categories.id |
| 排行类型 | 单选按钮组 | 否 | 选择排行的指标 | 销量排行、销售额排行、利润排行 | 无 |
| 排序方式 | 单选按钮组 | 否 | 选择排序方式 | 降序、升序 | 无 |
| 显示数量 | 数字输入框 | 否 | 选择显示的商品数量 | 10、20、50、100 | 无 |

### 2.4 图表设计
- **图表类型**: 横向柱状图
- **X轴**: 销量/销售额/利润
- **Y轴**: 商品名称
- **图例**: 销量/销售额/利润
- **交互**: 支持悬停查看具体数值，支持点击商品跳转到商品详情页

### 2.5 数据表格设计
| 列名 | 类型 | 操作 | 数据来源 |
|------|------|------|----------|
| 排名 | 数字 | 无 | 计算字段 |
| 商品名称 | 文本 | 点击查看商品详情 | product_products.product_name |
| 商品分类 | 文本 | 无 | product_categories.category_name |
| 销量 | 数字 | 无 | order_items.quantity |
| 销售额 | 文本 | 无 | SUM(order_items.total_price) |
| 利润 | 文本 | 无 | 计算字段 (销售额 - 成本) |
| 单价 | 文本 | 无 | product_products.price |
| 转化率 | 文本 | 无 | 计算字段 (销量 / 浏览量) |
| 操作 | 按钮组 | 查看销售明细 | 无 |

### 2.6 交互设计
- 支持切换不同的排行类型
- 支持动态调整显示数量
- 支持点击商品名称跳转到商品详情页
- 支持数据导出（Excel、CSV、PDF）
- 支持按不同字段排序

## 3. 客户消费分析页

### 3.1 页面概述
- **页面URL**: `/admin/statistics/customer`
- **功能描述**: 展示客户消费行为分析，包括客户画像、消费习惯、留存率等，支持按客户等级、注册时间等维度筛选

### 3.2 页面布局
- **顶部筛选区**: 时间范围、客户等级、性别、年龄等筛选条件
- **客户概览区**: 关键指标卡片（总客户数、活跃客户数、复购率、平均消费金额）
- **图表展示区**: 客户消费分布图、客户留存率图、客户等级分布饼图
- **数据表格区**: 客户消费排行表格
- **底部操作区**: 数据导出按钮

### 3.3 筛选条件设计
| 字段名 | 类型 | 必填 | 说明 | 选项 | 关联字段 |
|-------|------|------|------|------|----------|
| 时间范围 | 单选按钮组 | 否 | 选择数据统计的时间范围 | 近7天、近30天、本月、上月、近3个月、自定义 | order_orders.created_at |
| 自定义时间 | 日期范围选择器 | 否 | 当时间范围选择自定义时显示 | 开始日期、结束日期 | order_orders.created_at |
| 客户等级 | 多选框 | 否 | 按客户等级筛选 | 普通会员、银卡会员、金卡会员、钻石会员 | customer_levels.id |
| 性别 | 多选框 | 否 | 按客户性别筛选 | 男、女、未知 | customer_customers.gender |
| 年龄范围 | 数字范围选择器 | 否 | 按客户年龄筛选 | 开始年龄、结束年龄 | customer_customers.birthday |
| 消费金额范围 | 数字范围选择器 | 否 | 按客户消费金额筛选 | 开始金额、结束金额 | customer_customers.total_consumption |

### 3.4 客户概览卡片设计
| 卡片名称 | 数据指标 | 计算方式 | 数据来源 |
|---------|---------|---------|----------|
| 总客户数 | 显示所选时间范围内的总客户数 | COUNT(*) | customer_customers |
| 活跃客户数 | 显示所选时间范围内有消费的客户数 | COUNT(DISTINCT customer_id) | order_orders |
| 复购率 | 显示所选时间范围内的复购率 | 复购客户数 / 总客户数 | order_orders |
| 平均消费金额 | 显示所选时间范围内的平均消费金额 | AVG(total_consumption) | customer_customers |
| 新客户占比 | 显示所选时间范围内的新客户占比 | 新客户数 / 总客户数 | customer_customers.register_time |
| 客户留存率 | 显示所选时间范围内的客户留存率 | 留存客户数 / 总客户数 | order_orders |

### 3.5 图表设计

#### 3.5.1 客户消费分布图
- **图表类型**: 直方图
- **X轴**: 消费金额区间
- **Y轴**: 客户数量
- **交互**: 支持悬停查看具体数值，支持调整区间大小

#### 3.5.2 客户留存率图
- **图表类型**: 折线图
- **X轴**: 时间（日、周、月）
- **Y轴**: 留存率
- **图例**: 次日留存、7日留存、30日留存
- **交互**: 支持悬停查看具体数值，支持缩放和平移

#### 3.5.3 客户等级分布饼图
- **图表类型**: 饼图
- **数据维度**: 客户等级
- **交互**: 支持点击饼图区域查看详细数据

### 3.6 数据表格设计
| 列名 | 类型 | 操作 | 数据来源 |
|------|------|------|----------|
| 排名 | 数字 | 无 | 计算字段 |
| 客户名称 | 文本 | 点击查看客户详情 | customer_customers.username |
| 客户等级 | 文本 | 无 | customer_levels.level_name |
| 消费金额 | 文本 | 无 | customer_customers.total_consumption |
| 订单数 | 数字 | 无 | customer_customers.order_count |
| 最后消费时间 | 时间 | 无 | customer_customers.last_order_time |
| 平均客单价 | 文本 | 无 | 计算字段 |
| 复购次数 | 数字 | 无 | 计算字段 |
| 操作 | 按钮组 | 查看消费明细 | 无 |

### 3.7 交互设计
- 支持多条件组合筛选客户
- 支持切换不同的图表类型
- 支持点击客户名称跳转到客户详情页
- 支持数据导出（Excel、CSV、PDF）
- 支持按不同字段排序

## 4. 流量统计页

### 4.1 页面概述
- **页面URL**: `/admin/statistics/traffic`
- **功能描述**: 展示网站流量统计，包括访客数、浏览量、跳出率等，支持按时间、设备类型等维度筛选

### 4.2 页面布局
- **顶部筛选区**: 时间范围、设备类型、来源渠道等筛选条件
- **流量概览区**: 关键指标卡片（访客数、浏览量、人均浏览量、跳出率）
- **图表展示区**: 流量趋势图、来源渠道分布图、设备类型分布图
- **数据表格区**: 页面访问排行表格
- **底部操作区**: 数据导出按钮

### 4.3 筛选条件设计
| 字段名 | 类型 | 必填 | 说明 | 选项 | 数据来源 |
|-------|------|------|------|------|----------|
| 时间范围 | 单选按钮组 | 否 | 选择数据统计的时间范围 | 今日、昨日、近7天、近30天、本月、上月、自定义 | 系统日志 |
| 自定义时间 | 日期范围选择器 | 否 | 当时间范围选择自定义时显示 | 开始日期、结束日期 | 系统日志 |
| 设备类型 | 多选框 | 否 | 按设备类型筛选 | PC端、移动端、平板端 | 系统日志 |
| 来源渠道 | 多选框 | 否 | 按来源渠道筛选 | 直接访问、搜索引擎、社交媒体、广告推广 | 系统日志 |
| 浏览器 | 多选框 | 否 | 按浏览器筛选 | Chrome、Firefox、Safari、Edge、其他 | 系统日志 |
| 数据维度 | 单选按钮组 | 否 | 选择数据统计的维度 | 小时、日、周、月 | 无 |

### 4.4 流量概览卡片设计
| 卡片名称 | 数据指标 | 计算方式 | 数据来源 |
|---------|---------|---------|----------|
| 访客数 | 显示所选时间范围内的独立访客数 | COUNT(DISTINCT IP) | 系统日志 |
| 浏览量 | 显示所选时间范围内的页面浏览量 | COUNT(*) | 系统日志 |
| 人均浏览量 | 显示所选时间范围内的人均浏览量 | 浏览量 / 访客数 | 计算字段 |
| 跳出率 | 显示所选时间范围内的跳出率 | 跳出次数 / 访问次数 | 系统日志 |
| 平均访问时长 | 显示所选时间范围内的平均访问时长 | 总访问时长 / 访问次数 | 系统日志 |
| 新访客占比 | 显示所选时间范围内的新访客占比 | 新访客数 / 总访客数 | 系统日志 |

### 4.5 图表设计

#### 4.5.1 流量趋势图
- **图表类型**: 折线图
- **X轴**: 时间（小时、日、周、月）
- **Y轴**: 访客数、浏览量
- **图例**: 访客数、浏览量
- **交互**: 支持悬停查看具体数值，支持缩放和平移

#### 4.5.2 来源渠道分布图
- **图表类型**: 饼图
- **数据维度**: 来源渠道
- **交互**: 支持点击饼图区域查看详细数据

#### 4.5.3 设备类型分布图
- **图表类型**: 柱状图
- **X轴**: 设备类型
- **Y轴**: 访客数、浏览量
- **交互**: 支持悬停查看具体数值，支持切换Y轴数据类型

### 4.6 数据表格设计
| 列名 | 类型 | 操作 | 数据来源 |
|------|------|------|----------|
| 排名 | 数字 | 无 | 计算字段 |
| 页面URL | 文本 | 无 | 系统日志 |
| 浏览量 | 数字 | 无 | 系统日志 |
| 访客数 | 数字 | 无 | 系统日志 |
| 人均浏览时长 | 文本 | 无 | 计算字段 |
| 跳出率 | 文本 | 无 | 计算字段 |
| 转化率 | 文本 | 无 | 计算字段 |
| 操作 | 按钮组 | 查看页面详情 | 无 |

### 4.7 交互设计
- 支持多条件组合筛选流量数据
- 支持切换不同的图表类型
- 支持点击页面URL查看页面详情
- 支持数据导出（Excel、CSV、PDF）
- 支持按不同字段排序

## 5. 通用设计规范

### 5.1 样式规范
- 使用Ant Design/Element UI组件库
- 统一的颜色主题和字体
- 响应式布局，适配不同屏幕尺寸
- 图表使用统一的配色方案
- 数据表格使用统一的样式

### 5.2 交互规范
- 表单验证实时反馈
- 操作成功/失败提示
- 确认弹窗（删除、批量操作等）
- 加载状态提示
- 支持键盘快捷键操作
- 数据自动刷新，可配置刷新频率

### 5.3 数据规范
- 所有数据操作都需记录操作日志
- 支持数据的导入导出
- 支持数据的批量操作
- 数据展示支持分页和筛选
- 数据计算使用统一的公式

## 6. 技术实现建议

### 6.1 前端技术栈
- React/Vue
- Ant Design/Element UI
- ECharts（图表库）
- Axios
- React Router/Vue Router
- Day.js（时间处理）
- xlsx（Excel导出）

### 6.2 后端技术栈
- Spring Boot
- MyBatis-Plus
- MySQL
- Redis（缓存统计数据）
- Elasticsearch（日志和统计数据）
- Quartz（定时任务，预计算统计数据）

### 6.3 性能优化
- 统计数据预计算，定时更新
- 使用缓存存储热点统计数据
- 图表数据分页加载
- 延迟加载非关键数据
- 使用WebSocket实现数据实时更新

### 6.4 安全考虑
- API接口权限控制
- 敏感数据加密传输
- 防止SQL注入
- 防止XSS攻击
- 限流保护，防止恶意请求
- 数据访问审计

## 7. 后续迭代建议

### 7.1 功能扩展
- 添加自定义报表功能
- 添加数据预警功能
- 添加多维度交叉分析
- 添加预测分析功能
- 添加报表订阅功能

### 7.2 体验优化
- 支持拖拽调整图表位置
- 支持自定义仪表板
- 支持图表数据钻取
- 添加数据可视化模板
- 支持移动端适配

### 7.3 技术升级
- 微服务架构拆分
- 分布式缓存
- 消息队列异步处理
- 实时数据处理
- 容器化部署

## 8. 总结

数据统计模块是电商后台管理系统的重要组成部分，包含销售统计报表页、商品销售排行页、客户消费分析页和流量统计页四个主要页面。本设计方案基于MySQL数据库表结构，结合了现代前端技术和最佳实践，实现了多维度的数据统计和可视化展示。

设计方案考虑了用户体验、性能优化和安全考虑，并提供了后续迭代建议，为电商后台管理系统的数据统计功能提供了完整的解决方案。